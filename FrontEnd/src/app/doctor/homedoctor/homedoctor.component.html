<div class="card">
  <div class="header">
    <h2>ğŸ“… Danh sÃ¡ch Lá»‹ch Háº¹n</h2>
   
  </div>

  <!-- Bá»™ lá»c -->
  <div class="filters">
    <div class="filter-group">
      <label>
        <i class="fas fa-calendar"></i>
        <input type="date" [(ngModel)]="filterDate" class="filter-input">
        <button class="btn btn-sm btn-secondary" (click)="filterByDate()">Lá»c</button>
      </label>
    </div>

    <div class="filter-group">
      <label>
        <i class="fas fa-calendar-alt"></i>
        <input type="number" min="1" max="12" [(ngModel)]="filterMonth" placeholder="ThÃ¡ng" class="filter-input small">
        <input type="number" min="2000" max="2100" [(ngModel)]="filterYear" placeholder="NÄƒm" class="filter-input small">
        <button class="btn btn-sm btn-secondary" (click)="filterByMonth()">Lá»c</button>
      </label>
    </div>

    <div class="filter-group">
      <label>
        <i class="fas fa-filter"></i>
        <select [(ngModel)]="filterStatus" class="filter-input">
          <option value="">--Chá»n--</option>
          <option value="PENDING">Chá» xÃ¡c nháº­n</option>
          <option value="SCHEDULED">ÄÃ£ xÃ¡c nháº­n</option>
          <option value="COMPLETED">ÄÃ£ hoÃ n thÃ nh</option>
          <option value="CANCELLED">ÄÃ£ huá»·</option>
        </select>
        <button class="btn btn-sm btn-secondary" (click)="filterByStatus()">Lá»c</button>
      </label>
    </div>

    <button class="btn btn-sm btn-primary" (click)="loadAppointments()">
      <i class="fas fa-sync"></i> Táº¥t cáº£
    </button>
  </div>

  <div class="table-wrapper">
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>ğŸ¾ TÃªn ThÃº CÆ°ng</th>
          <th>ğŸ‘¤ Chá»§ ThÃº CÆ°ng</th>
          <th>ğŸ•’ NgÃ y Háº¹n</th>
          <th>ğŸ“ Ghi ChÃº</th>
          <th>ğŸ“Œ Tráº¡ng ThÃ¡i</th>
          <th>ğŸ’¼ Dá»‹ch Vá»¥</th>
          <th>ğŸ”§ HÃ nh Ä‘á»™ng</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let appoi of paginatedAppointments">
          <td>{{ appoi.id }}</td>
          <td>{{ appoi.petName }}</td>
          <td>{{ appoi.petOwnerName }}</td>
          <td>{{ appoi.appointmentDate | date:'short' }}</td>
          <td>{{ appoi.note }}</td>
          <td>
            <span class="status-badge" [ngClass]="{
              'status-pending': appoi.status === 'PENDING',
              'status-scheduled': appoi.status === 'SCHEDULED',
              'status-completed': appoi.status === 'COMPLETED',
              'status-cancelled': appoi.status === 'CANCELLED'
            }">{{ appoi.status }}</span>
          </td>
          <td>
            <span *ngFor="let s of appoi.services; let last = last">
              {{ s }}<span *ngIf="!last">, </span>
            </span>
          </td>
          <td class="actions">
            <!-- XÃ¡c nháº­n lá»‹ch háº¹n (PENDING -> SCHEDULED) -->
            <button *ngIf="appoi.status === 'PENDING'" 
                    class="btn btn-success" 
                    (click)="confirmAppointment(appoi.id)">
              <i class="fas fa-check"></i> XÃ¡c nháº­n
            </button>

            <!-- ÄÃ¡nh dáº¥u hoÃ n thÃ nh (SCHEDULED -> COMPLETED) -->
            <button *ngIf="appoi.status === 'SCHEDULED'" 
                    class="btn btn-primary" 
                    (click)="markCompleted(appoi.id)">
              <i class="fas fa-check-double"></i> HoÃ n thÃ nh
            </button>

            <!-- Huá»· lá»‹ch háº¹n (PENDING/SCHEDULED -> CANCELLED) -->
            <button *ngIf="appoi.status === 'PENDING' || appoi.status === 'SCHEDULED'" 
                    class="btn btn-danger" 
                    (click)="cancelAppointment(appoi.id)">
              <i class="fas fa-times"></i> Huá»·
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Pagination -->
  <div class="pagination" *ngIf="totalPages > 1">
    <button class="btn btn-sm" 
            [disabled]="currentPage === 1"
            (click)="goToPage(currentPage - 1)">
      <i class="fas fa-chevron-left"></i>
    </button>
    
    <button class="btn btn-sm" 
            *ngFor="let page of getPageNumbers()"
            [class.active]="page === currentPage"
            (click)="goToPage(page)">
      {{ page }}
    </button>
    
    <button class="btn btn-sm"
            [disabled]="currentPage === totalPages"
            (click)="goToPage(currentPage + 1)">
      <i class="fas fa-chevron-right"></i>
    </button>
  </div>
</div>